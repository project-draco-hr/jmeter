{
  String host=smtpHost;
  boolean debug=Boolean.valueOf(host).booleanValue();
  InternetAddress[] address=new InternetAddress[vEmails.size()];
  for (int k=0; k < vEmails.size(); k++) {
    address[k]=new InternetAddress(vEmails.elementAt(k).toString());
  }
  Properties props=new Properties();
  props.put(MAIL_SMTP_HOST,host);
  Session session=Session.getDefaultInstance(props,null);
  props=session.getProperties();
  if (!host.equalsIgnoreCase(props.getProperty(MAIL_SMTP_HOST))) {
    props.setProperty(MAIL_SMTP_HOST,host);
  }
  session.setDebug(debug);
  Message msg=new MimeMessage(session);
  msg.setFrom(new InternetAddress(from));
  msg.setRecipients(Message.RecipientType.TO,address);
  msg.setSubject(subject);
  msg.setText(attText);
  Transport.send(msg);
}
