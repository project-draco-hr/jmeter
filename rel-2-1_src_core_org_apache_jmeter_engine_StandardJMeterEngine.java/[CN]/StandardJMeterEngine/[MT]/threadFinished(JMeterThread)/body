{
  try {
    allThreads.remove(thread);
    log.info("Ending thread " + thread.getThreadNum());
    if (!serialized && allThreads.size() == 0 && !schcdule_run) {
      log.info("Stopping test");
      stopTest();
    }
  }
 catch (  Throwable e) {
    log.fatalError("Call to threadFinished should never throw an exception - this can deadlock JMeter",e);
  }
}
