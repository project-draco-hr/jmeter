{
  String chs;
  NodeReader rd;
  BufferedInputStream in;
  if ((null != encoding) && !"".equals(encoding))   if (null == getConnection())   character_set=encoding;
 else {
    rd=getReader();
    chs=getEncoding();
    in=input;
    try {
      character_set=encoding;
      recreateReader();
    }
 catch (    IOException ioe) {
      String msg="setEncoding() : Error in opening a connection to " + getConnection().getURL().toExternalForm();
      ParserException ex=new ParserException(msg,ioe);
      feedback.error(msg,ex);
      character_set=chs;
      reader=rd;
      input=in;
      throw ex;
    }
  }
}
