{
  List<String> res=new ArrayList<>();
  X509Principal subject=PrincipalUtil.getSubjectX509Principal(cert);
  Vector<?> addresses=subject.getValues(X509Name.EmailAddress);
  for (  Object address : addresses) {
    res.add((String)address);
  }
  Collection<?> subjectAltNames=X509ExtensionUtil.getSubjectAlternativeNames(cert);
  for (  Object altNameObj : subjectAltNames) {
    List<?> altName=(List<?>)altNameObj;
    int type=(Integer)altName.get(0);
    if (type == GeneralName.rfc822Name) {
      String address=(String)altName.get(1);
      res.add(address);
    }
  }
  return res;
}
