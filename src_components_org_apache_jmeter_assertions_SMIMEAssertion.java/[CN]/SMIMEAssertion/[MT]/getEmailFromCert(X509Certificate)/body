{
  List<String> res=new ArrayList<String>();
  X509Principal subject=PrincipalUtil.getSubjectX509Principal(cert);
  Iterator addressIt=subject.getValues(X509Principal.EmailAddress).iterator();
  while (addressIt.hasNext()) {
    String address=(String)addressIt.next();
    res.add(address);
  }
  Iterator subjectAltNamesIt=X509ExtensionUtil.getSubjectAlternativeNames(cert).iterator();
  while (subjectAltNamesIt.hasNext()) {
    List altName=(List)subjectAltNamesIt.next();
    int type=((Integer)altName.get(0)).intValue();
    if (type == GeneralName.rfc822Name) {
      String address=(String)altName.get(1);
      res.add(address);
    }
  }
  return res;
}
