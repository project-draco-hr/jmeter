{
  String action=e.getActionCommand();
  if (action.equals(DELETE)) {
    if (table.isEditing()) {
      TableCellEditor cellEditor=table.getCellEditor(table.getEditingRow(),table.getEditingColumn());
      cellEditor.cancelCellEditing();
    }
    int rowSelected=table.getSelectedRow();
    if (rowSelected >= 0) {
      tableModel.removeRow(rowSelected);
      tableModel.fireTableDataChanged();
      if (tableModel.getRowCount() == 0) {
        delete.setEnabled(false);
      }
 else {
        int rowToSelect=rowSelected;
        if (rowSelected >= tableModel.getRowCount()) {
          rowToSelect=rowSelected - 1;
        }
        table.setRowSelectionInterval(rowToSelect,rowToSelect);
      }
    }
  }
 else   if (action.equals(ADD)) {
    if (table.isEditing()) {
      TableCellEditor cellEditor=table.getCellEditor(table.getEditingRow(),table.getEditingColumn());
      cellEditor.stopCellEditing();
    }
    tableModel.addNewRow();
    tableModel.fireTableDataChanged();
    delete.setEnabled(true);
    int rowToSelect=tableModel.getRowCount() - 1;
    table.setRowSelectionInterval(rowToSelect,rowToSelect);
  }
}
