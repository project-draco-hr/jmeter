{
  if (level == 0 && (parent_name == null || parent_name.length() == 0)) {
    nodesModel.addElement(new TreeNodeWrapper(null,""));
  }
  String seperator=" > ";
  if (node != null) {
    StringBuilder name=new StringBuilder();
    for (int i=0; i < node.getChildCount(); i++) {
      name.setLength(0);
      JMeterTreeNode cur=(JMeterTreeNode)node.getChildAt(i);
      TestElement te=cur.getTestElement();
      if (te instanceof AbstractThreadGroup) {
        name.append(parent_name);
        name.append(cur.getName());
        name.append(seperator);
        buildNodesModel(cur,name.toString(),level);
      }
 else       if (te instanceof Controller && !(te instanceof ModuleController)) {
        name.append(spaces(level));
        name.append(parent_name);
        name.append(cur.getName());
        TreeNodeWrapper tnw=new TreeNodeWrapper(cur,name.toString());
        nodesModel.addElement(tnw);
        name.setLength(0);
        name.append(cur.getName());
        name.append(seperator);
        buildNodesModel(cur,name.toString(),level + 1);
      }
 else       if (te instanceof TestPlan || te instanceof WorkBench) {
        name.append(cur.getName());
        name.append(seperator);
        buildNodesModel(cur,name.toString(),0);
      }
    }
  }
}
