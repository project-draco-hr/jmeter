{
  if (!sample.isSuccessful()) {
    failureCount++;
    successCount=0;
  }
 else {
    successCount++;
  }
  if ((failureCount > getFailureLimit()) && !siteDown && !failureMsgSent) {
    Vector<String> addressVector=getAddressVector();
    if (addressVector.size() != 0) {
      try {
        sendMail(getFromAddress(),addressVector,getFailureSubject(),"URL Failed: " + sample.getSampleLabel(),getSmtpHost());
      }
 catch (      Exception e) {
        log.error("Problem sending mail",e);
      }
      siteDown=true;
      failureMsgSent=true;
      successCount=0;
      successMsgSent=false;
    }
  }
  if (siteDown && (sample.getTime() != -1) && !successMsgSent) {
    if (successCount > getSuccessLimit()) {
      Vector<String> addressVector=getAddressVector();
      try {
        sendMail(getFromAddress(),addressVector,getSuccessSubject(),"URL Restarted: " + sample.getSampleLabel(),getSmtpHost());
      }
 catch (      Exception e) {
        log.error("Problem sending mail",e);
      }
      siteDown=false;
      successMsgSent=true;
      failureCount=0;
      failureMsgSent=false;
    }
  }
  if (successMsgSent && failureMsgSent) {
    clear();
  }
  notifyChangeListeners();
}
