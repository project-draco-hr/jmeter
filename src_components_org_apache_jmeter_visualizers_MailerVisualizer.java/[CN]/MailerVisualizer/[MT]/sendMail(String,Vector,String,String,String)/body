{
  try {
    String host=SMTPHost;
    boolean debug=Boolean.valueOf(host).booleanValue();
    InetAddress remote=InetAddress.getByName(host);
    InternetAddress[] address=new InternetAddress[vEmails.size()];
    for (int k=0; k < vEmails.size(); k++) {
      address[k]=new InternetAddress(vEmails.elementAt(k).toString());
    }
    Properties props=new Properties();
    props.put("mail.smtp.host",host);
    Session session=Session.getDefaultInstance(props,null);
    session.setDebug(debug);
    Message msg=new MimeMessage(session);
    msg.setFrom(new InternetAddress(from));
    msg.setRecipients(Message.RecipientType.TO,address);
    msg.setSubject(subject);
    msg.setText(attText);
    Transport.send(msg);
    System.out.println("Mail sent successfully!!");
  }
 catch (  UnknownHostException e1) {
    System.out.println("Invalid Mail Server " + e1);
    JOptionPane.showMessageDialog(null,JMeterUtils.getResString("invalid_mail_server"),"Error",JOptionPane.ERROR_MESSAGE);
  }
catch (  Exception e) {
    System.out.println("Couldn't send mail...");
    JOptionPane.showMessageDialog(null,JMeterUtils.getResString("mailer_error"),"Error",JOptionPane.ERROR_MESSAGE);
  }
}
