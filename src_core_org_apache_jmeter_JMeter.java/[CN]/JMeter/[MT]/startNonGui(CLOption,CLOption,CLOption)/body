{
  System.setProperty("JMeter.NonGui","true");
  JMeter driver=new JMeter();
  driver.remoteProps=this.remoteProps;
  driver.remoteStop=this.remoteStop;
  driver.parent=this;
  PluginManager.install(this,false);
  String remote_hosts_string=null;
  if (remoteStart != null) {
    remote_hosts_string=remoteStart.getArgument();
    if (remote_hosts_string == null) {
      remote_hosts_string=JMeterUtils.getPropDefault("remote_hosts","127.0.0.1");
    }
  }
  if (testFile == null) {
    throw new IllegalUserActionException("Non-GUI runs require a test plan");
  }
  String argument=testFile.getArgument();
  if (argument == null) {
    throw new IllegalUserActionException("Non-GUI runs require a test plan");
  }
  if (logFile == null) {
    driver.run(argument,null,remoteStart != null,remote_hosts_string);
  }
 else {
    driver.run(argument,logFile.getArgument(),remoteStart != null,remote_hosts_string);
  }
}
