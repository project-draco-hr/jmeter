{
  fireIterEventAsNeeded();
  TestElement controller=getCurrentController();
  if (controller == null) {
    nextAtEnd();
    return next();
  }
  if (controller instanceof Sampler) {
    incrementCurrent();
    return (Sampler)controller;
  }
 else {
    Controller c=(Controller)controller;
    if (c.hasNext()) {
      Sampler s=c.next();
      return s;
    }
 else     if (c.isDone()) {
      removeCurrentController();
      return next();
    }
 else {
      incrementCurrent();
      return next();
    }
  }
}
