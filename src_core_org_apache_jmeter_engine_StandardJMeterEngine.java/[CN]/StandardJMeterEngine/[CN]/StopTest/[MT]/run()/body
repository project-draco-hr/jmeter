{
  if (running) {
    running=false;
    if (now) {
      tellThreadsToStop();
    }
 else {
      stopAllThreads();
    }
    try {
      Thread.sleep(10 * allThreads.size());
    }
 catch (    InterruptedException e) {
    }
    boolean stopped=verifyThreadsStopped();
    if (stopped || now) {
      notifyTestListenersOfEnd();
    }
  }
}
