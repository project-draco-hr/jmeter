{
  boolean stoppedAll=true;
  for (  Thread t : allThreads.values()) {
    if (t != null) {
      if (t.isAlive()) {
        try {
          t.join(WAIT_TO_DIE);
        }
 catch (        InterruptedException e) {
        }
        if (t.isAlive()) {
          stoppedAll=false;
          log.warn("Thread won't exit: " + t.getName());
        }
      }
    }
  }
  return stoppedAll;
}
