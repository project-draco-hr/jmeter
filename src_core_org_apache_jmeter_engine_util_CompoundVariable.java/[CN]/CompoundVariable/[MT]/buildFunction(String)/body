{
  Function returnFunction=null;
  LinkedList parameterList;
  String functionName, params, decodedParams;
  int paramsStart=functionStr.indexOf("(");
  if (paramsStart > -1)   functionName=functionStr.substring(0,functionStr.indexOf("("));
 else   functionName=functionStr;
  if (functions.containsKey(functionName)) {
    Object replacement=functions.get(functionName);
    params=extractParams(functionStr);
    decodedParams=ArgumentDecoder.decode(params);
    try {
      returnFunction=(Function)((Class)replacement).newInstance();
      Collection paramList=parseParams(decodedParams);
      returnFunction.setParameters(paramList);
    }
 catch (    Exception e) {
      log.error("",e);
      throw new InvalidVariableException();
    }
  }
  return returnFunction;
}
