{
  Iterator iter=new LinkedList(tree.list()).iterator();
  while (iter.hasNext()) {
    JMeterTreeNode item=(JMeterTreeNode)iter.next();
    if (item.isEnabled()) {
      if (item.getUserObject() instanceof ReplaceableController) {
        ReplaceableController rc=(ReplaceableController)item.getTestElement();
        HashTree subTree=tree.getTree(item);
        if (subTree != null) {
          rc.replace(subTree);
          convertSubTree(subTree);
          tree.replace(item,rc.getReplacement());
        }
      }
 else {
        convertSubTree(tree.getTree(item));
        TestElement testElement=item.getTestElement();
        tree.replace(item,testElement);
      }
    }
 else {
      tree.remove(item);
    }
  }
}
