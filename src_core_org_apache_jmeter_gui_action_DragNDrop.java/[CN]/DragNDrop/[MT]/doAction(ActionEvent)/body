{
  String action=e.getActionCommand();
  JMeterTreeNode draggedNode=GuiPackage.getInstance().getTreeListener().getDraggedNode();
  JMeterTreeListener treeListener=GuiPackage.getInstance().getTreeListener();
  JMeterTreeNode currentNode=treeListener.getCurrentNode();
  GuiPackage.getInstance().getTreeModel().removeNodeFromParent(GuiPackage.getInstance().getTreeListener().getDraggedNode());
  if (ADD.equals(action)) {
    GuiPackage.getInstance().getTreeModel().insertNodeInto(draggedNode,currentNode,currentNode.getChildCount());
  }
 else   if (INSERT_BEFORE.equals(action)) {
    JMeterTreeNode parentNode=(JMeterTreeNode)currentNode.getParent();
    int index=parentNode.getIndex(currentNode);
    GuiPackage.getInstance().getTreeModel().insertNodeInto(draggedNode,parentNode,index);
  }
 else   if (INSERT_AFTER.equals(action)) {
    JMeterTreeNode parentNode=(JMeterTreeNode)currentNode.getParent();
    int index=parentNode.getIndex(currentNode) + 1;
    GuiPackage.getInstance().getTreeModel().insertNodeInto(draggedNode,parentNode,index);
  }
  GuiPackage.getInstance().getMainFrame().repaint();
}
