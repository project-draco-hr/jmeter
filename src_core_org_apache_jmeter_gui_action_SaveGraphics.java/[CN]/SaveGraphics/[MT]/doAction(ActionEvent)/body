{
  JMeterGUIComponent component=null;
  JComponent comp=null;
  if (!commands.contains(e.getActionCommand())) {
    throw new IllegalUserActionException("Invalid user command:" + e.getActionCommand());
  }
  if (e.getActionCommand().equals(SAVE_GRAPHICS)) {
    component=GuiPackage.getInstance().getCurrentGui();
    if (component instanceof Printable) {
      comp=((Printable)component).getPrintableComponent();
      String filename;
      JFileChooser chooser=FileDialoger.promptToSaveFile(GuiPackage.getInstance().getTreeListener().getCurrentNode().getName(),extensions);
      if (chooser == null) {
        return;
      }
      filename=chooser.getSelectedFile().getAbsolutePath();
      if (filename != null) {
        SaveGraphicsService save=new SaveGraphicsService();
        String ext=filename.substring(filename.length() - 4);
        String name=filename.substring(0,filename.length() - 4);
        if (ext.equals(SaveGraphicsService.PNG_EXTENSION)) {
          save.saveJComponent(name,SaveGraphicsService.PNG,comp);
        }
 else         if (ext.equals(SaveGraphicsService.TIFF_EXTENSION)) {
          save.saveJComponent(name,SaveGraphicsService.TIFF,comp);
        }
 else {
          save.saveJComponent(filename,SaveGraphicsService.PNG,comp);
        }
      }
    }
  }
}
