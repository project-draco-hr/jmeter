{
  final String selectedTemplate=templateList.getText();
  final Template template=TemplateManager.getInstance().getTemplateByName(selectedTemplate);
  final String fileName=template.getFileName();
  final File fileToCopy=new File(JMeterUtils.getJMeterHome(),fileName);
  final File targetFile=new File(System.getProperty("user.dir"),fileName.substring(fileName.lastIndexOf("/")));
  InputStream inputStream=null;
  OutputStream outputStream=null;
  try {
    inputStream=new BufferedInputStream(new FileInputStream(fileToCopy));
    outputStream=new BufferedOutputStream(new FileOutputStream(targetFile));
    IOUtils.copy(inputStream,outputStream);
    outputStream.close();
    Load.loadProjectFile(e,targetFile,false);
    this.setVisible(false);
  }
 catch (  Exception e1) {
    throw new Error(e1);
  }
 finally {
    JOrphanUtils.closeQuietly(inputStream);
    JOrphanUtils.closeQuietly(outputStream);
  }
}
