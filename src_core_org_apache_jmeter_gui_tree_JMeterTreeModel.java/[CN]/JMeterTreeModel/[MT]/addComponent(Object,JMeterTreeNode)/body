{
  if ((node.getUserObject() instanceof TestPlanGui) && !(component instanceof ThreadGroupGui)) {
    throw new IllegalUserActionException("Only ThreadGroups can be added to Test Plan nodes");
  }
  if (node.getUserObject() instanceof AbstractConfigGui) {
    throw new IllegalUserActionException("This node cannot hold sub-elements");
  }
  JMeterTreeNode newNode=new JMeterTreeNode((JMeterGUIComponent)component);
  this.insertNodeInto(newNode,node,node.getChildCount());
  return newNode;
}
