{
  if (sample == null) {
    throw new ArgumentNullException("sample");
  }
  if (writer == null) {
    throw new IllegalStateException("No writer set! Call setWriter() first!");
  }
  row.setLength(0);
  char[] specials=new char[]{separator,CSVSaveService.QUOTING_CHAR,CharUtils.CR,CharUtils.LF};
  for (int i=0; i < columnCount; i++) {
    String data=sample.getString(i);
    row.append(CSVSaveService.quoteDelimiters(data,specials)).append(separator);
  }
  int rowLength=row.length() - 1;
  row.setLength(rowLength);
  writer.println(row.toString());
  sampleCount++;
  return sampleCount;
}
