{
  if (filename == null || filename.length() == 0) {
    return null;
  }
  PrintWriter writer=(PrintWriter)files.get(filename);
  boolean trimmed=true;
  if (writer == null) {
    trimmed=trimLastLine(filename);
    writer=new PrintWriter(new OutputStreamWriter(new BufferedOutputStream(new FileOutputStream(filename,trimmed)),"UTF-8"));
    files.put(filename,writer);
  }
  if (!trimmed) {
    writeFileStart(writer);
  }
  return writer;
}
