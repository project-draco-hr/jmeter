{
  boolean parsedOK=false;
  if (new File(getFilename()).exists()) {
    clearVisualizer();
    BufferedReader dataReader=null;
    try {
      readSamples(SaveService.loadTestResults(new BufferedInputStream(new FileInputStream(getFilename()))));
      parsedOK=true;
    }
 catch (    Exception e) {
      log.warn("File load failure, trying old data format.",e);
      try {
        Configuration savedSamples=getConfiguration(getFilename());
        Configuration[] samples=savedSamples.getChildren();
        for (int i=0; i < samples.length; i++) {
          SampleResult result=OldSaveService.getSampleResult(samples[i]);
          sendToVisualizer(result);
        }
      }
 catch (      Exception e1) {
        log.warn("Error parsing XML results " + e);
        log.info("Assuming CSV format instead");
        dataReader=new BufferedReader(new FileReader(getFilename()));
        String line;
        while ((line=dataReader.readLine()) != null) {
          sendToVisualizer(OldSaveService.makeResultFromDelimitedString(line));
        }
        parsedOK=true;
      }
    }
 finally {
      if (dataReader != null)       dataReader.close();
      if (!parsedOK) {
        SampleResult sr=new SampleResult();
        sr.setSampleLabel("Error loading results file - see log file");
        sendToVisualizer(sr);
      }
    }
  }
}
