{
  useNanoTime=USENANOTIME;
  nanoTimeOffset=initOffset();
  long now=currentTimeInMillis();
  if (atend) {
    setTimes(now - elapsed,now);
  }
 else {
    setTimes(now,now + elapsed);
  }
}
