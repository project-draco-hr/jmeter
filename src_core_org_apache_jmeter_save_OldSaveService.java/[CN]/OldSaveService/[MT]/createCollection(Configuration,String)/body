{
  Collection coll=(Collection)Class.forName(config.getAttribute("class")).newInstance();
  Configuration[] items=config.getChildren();
  for (int i=0; i < items.length; i++) {
    if (items[i].getName().equals("property")) {
      coll.add(createProperty(items[i],testClass));
    }
 else     if (items[i].getName().equals("testelement")) {
      coll.add(new TestElementProperty(items[i].getAttribute("name",""),createTestElement(items[i])));
    }
 else     if (items[i].getName().equals("collection")) {
      coll.add(new CollectionProperty(items[i].getAttribute("name",""),createCollection(items[i],testClass)));
    }
 else     if (items[i].getName().equals("string")) {
      coll.add(createProperty(items[i],testClass));
    }
 else     if (items[i].getName().equals("map")) {
      coll.add(new MapProperty(items[i].getAttribute("name",""),createMap(items[i],testClass)));
    }
  }
  return coll;
}
