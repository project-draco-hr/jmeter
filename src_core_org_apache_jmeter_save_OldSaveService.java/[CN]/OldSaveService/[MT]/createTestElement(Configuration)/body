{
  TestElement element=null;
  String testClass=config.getAttribute("class");
  String gui_class="";
  Configuration[] children=config.getChildren();
  for (int i=0; i < children.length; i++) {
    if (children[i].getName().equals("property")) {
      if (children[i].getAttribute("name").equals(TestElement.GUI_CLASS)) {
        gui_class=children[i].getValue();
      }
    }
  }
  String newClass=NameUpdater.getCurrentTestName(testClass,gui_class);
  element=(TestElement)Class.forName(newClass).newInstance();
  for (int i=0; i < children.length; i++) {
    if (children[i].getName().equals("property")) {
      try {
        JMeterProperty prop=createProperty(children[i],newClass);
        if (prop != null)         element.setProperty(prop);
      }
 catch (      Exception ex) {
        log.error("Problem loading property",ex);
        element.setProperty(children[i].getAttribute("name"),"");
      }
    }
 else     if (children[i].getName().equals("testelement")) {
      element.setProperty(new TestElementProperty(children[i].getAttribute("name",""),createTestElement(children[i])));
    }
 else     if (children[i].getName().equals("collection")) {
      element.setProperty(new CollectionProperty(children[i].getAttribute("name",""),createCollection(children[i],newClass)));
    }
 else     if (children[i].getName().equals("map")) {
      element.setProperty(new MapProperty(children[i].getAttribute("name",""),createMap(children[i],newClass)));
    }
  }
  return element;
}
