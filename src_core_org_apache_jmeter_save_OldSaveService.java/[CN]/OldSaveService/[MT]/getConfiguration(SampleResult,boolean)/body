{
  DefaultConfiguration config=new DefaultConfiguration(SAMPLE_RESULT_TAG_NAME,"JMeter Save Service");
  if (_saveConfig.saveTime()) {
    config.setAttribute(TIME,"" + result.getTime());
  }
  if (_saveConfig.saveLabel()) {
    config.setAttribute(LABEL,result.getSampleLabel());
  }
  if (_saveConfig.saveCode()) {
    config.setAttribute(RESPONSE_CODE,result.getResponseCode());
  }
  if (_saveConfig.saveMessage()) {
    config.setAttribute(RESPONSE_MESSAGE,result.getResponseMessage());
  }
  if (_saveConfig.saveThreadName()) {
    config.setAttribute(THREAD_NAME,result.getThreadName());
  }
  if (_saveConfig.saveDataType()) {
    config.setAttribute(DATA_TYPE,result.getDataType());
  }
  if (_saveConfig.printMilliseconds()) {
    config.setAttribute(TIME_STAMP,"" + result.getTimeStamp());
  }
 else   if (_saveConfig.formatter() != null) {
    String stamp=_saveConfig.formatter().format(new Date(result.getTimeStamp()));
    config.setAttribute(TIME_STAMP,stamp);
  }
  if (_saveConfig.saveSuccess()) {
    config.setAttribute(SUCCESSFUL,JOrphanUtils.booleanToString(result.isSuccessful()));
  }
  SampleResult[] subResults=result.getSubResults();
  if (subResults != null) {
    for (int i=0; i < subResults.length; i++) {
      config.addChild(getConfiguration(subResults[i],funcTest));
    }
  }
  AssertionResult[] assResults=result.getAssertionResults();
  if (funcTest) {
    config.addChild(createConfigForString("samplerData",result.getSamplerData()));
    if (assResults != null) {
      for (int i=0; i < assResults.length; i++) {
        config.addChild(getConfiguration(assResults[i]));
      }
    }
    config.addChild(getConfiguration(result.getResponseData()));
  }
 else {
    if (_saveConfig.assertionsResultsToSave() == SampleSaveConfiguration.SAVE_ALL_ASSERTIONS) {
      config.addChild(createConfigForString("samplerData",result.getSamplerData()));
      if (assResults != null) {
        for (int i=0; i < assResults.length; i++) {
          config.addChild(getConfiguration(assResults[i]));
        }
      }
    }
 else     if ((_saveConfig.assertionsResultsToSave() == SampleSaveConfiguration.SAVE_FIRST_ASSERTION) && assResults != null && assResults.length > 0) {
      config.addChild(getConfiguration(assResults[0]));
    }
    if (_saveConfig.saveResponseData()) {
      config.addChild(getConfiguration(result.getResponseData()));
    }
  }
  return config;
}
