{
  if (!reader.markSupported()) {
    reader=new BufferedInputStream(reader);
  }
  reader.mark(Integer.MAX_VALUE);
  ScriptWrapper wrapper=null;
  try {
    InputStreamReader inputStreamReader=getInputStreamReader(reader);
    wrapper=(ScriptWrapper)saver.fromXML(inputStreamReader);
    inputStreamReader.close();
    return wrapper.testPlan;
  }
 catch (  CannotResolveClassException e) {
    log.warn("Problem loading new style: " + e.getLocalizedMessage());
    reader.reset();
    return OldSaveService.loadSubTree(reader);
  }
catch (  NoClassDefFoundError e) {
    log.warn("Missing class ",e);
    return null;
  }
}
