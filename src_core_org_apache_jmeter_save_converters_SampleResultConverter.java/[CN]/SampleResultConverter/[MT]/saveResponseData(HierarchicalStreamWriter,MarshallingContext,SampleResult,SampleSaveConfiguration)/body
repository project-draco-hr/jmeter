{
  if (save.saveResponseData(res)) {
    writer.startNode(TAG_RESPONSE_DATA);
    try {
      if (SampleResult.TEXT.equals(res.getDataType())) {
        writer.addAttribute(ATT_CLASS,JAVA_LANG_STRING);
        writer.setValue(new String(res.getResponseData(),res.getDataEncoding()));
      }
 else {
        writer.addAttribute(ATT_CLASS,JAVA_LANG_STRING);
        URL url=res.getURL();
        if (url != null) {
          writer.setValue(url.toExternalForm());
        }
 else {
          writer.setValue("Non-text data, but URL is null");
        }
      }
    }
 catch (    UnsupportedEncodingException e) {
      writer.setValue("Unsupported encoding in response data, can't record.");
    }
    writer.endNode();
  }
  if (save.saveFileName()) {
    writer.startNode(TAG_RESPONSE_FILE);
    writer.addAttribute(ATT_CLASS,JAVA_LANG_STRING);
    writer.setValue(res.getResultFileName());
    writer.endNode();
  }
}
