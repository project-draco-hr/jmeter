{
  TestSuite suite=new TestSuite("Bean Resource Test Suite");
  String[] languages=new String[]{"de","ja","no"};
  String defaultLanguage="en";
  Iterator iter=ClassFinder.findClassesThatExtend(JMeterUtils.getSearchPaths(),new Class[]{TestBean.class}).iterator();
  while (iter.hasNext()) {
    String className=(String)iter.next();
    Class testBeanClass=Class.forName(className);
    JMeterUtils.setLocale(new Locale(defaultLanguage,""));
    ResourceBundle defaultBundle;
    try {
      defaultBundle=(ResourceBundle)Introspector.getBeanInfo(testBeanClass).getBeanDescriptor().getValue(GenericTestBeanCustomizer.RESOURCE_BUNDLE);
    }
 catch (    IntrospectionException e) {
      log.error("Can't get beanInfo for " + testBeanClass.getName(),e);
      throw new Error(e.toString());
    }
    if (defaultBundle == null) {
      if (className.startsWith("org.apache.jmeter.examples.")) {
        log.warn("No default bundle found for " + className);
        continue;
      }
      throw new Error("No default bundle for class " + className);
    }
    suite.addTest(new PackageTest(testBeanClass,defaultLanguage,defaultBundle));
    for (int i=0; i < languages.length; i++) {
      suite.addTest(new PackageTest(testBeanClass,languages[i],defaultBundle));
    }
  }
  return suite;
}
