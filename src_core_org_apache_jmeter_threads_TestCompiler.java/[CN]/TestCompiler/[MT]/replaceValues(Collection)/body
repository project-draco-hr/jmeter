{
  Collection newColl=null;
  try {
    newColl=(Collection)values.getClass().newInstance();
  }
 catch (  Exception e) {
    log.error("",e);
    return values;
  }
  Iterator iter=values.iterator();
  while (iter.hasNext()) {
    Object val=iter.next();
    if (val instanceof TestElement) {
      replaceValues((TestElement)val);
    }
 else     if (val instanceof Function) {
      try {
        val=((Function)val).execute(previousResult,currentSampler);
      }
 catch (      InvalidVariableException e) {
      }
    }
 else     if (val instanceof Collection) {
      val=replaceValues((Collection)val);
    }
    newColl.add(val);
  }
  return newColl;
}
