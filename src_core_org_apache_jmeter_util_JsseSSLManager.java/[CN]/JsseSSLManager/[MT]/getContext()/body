{
  if (null == this.context) {
    try {
      if (pro != null) {
        this.context=SSLContext.getInstance("TLS",pro);
      }
 else {
        this.context=SSLContext.getInstance("TLS");
      }
      log.debug("SSL context = " + context);
    }
 catch (    Exception ee) {
      log.error("Exception occurred",ee);
    }
    try {
      KeyManagerFactory managerFactory=KeyManagerFactory.getInstance("SunX509");
      JmeterKeyStore keys=this.getKeyStore();
      managerFactory.init(null,this.defaultpw.toCharArray());
      KeyManager[] managers=managerFactory.getKeyManagers();
      log.info(keys.getClass().toString());
      for (int i=0; i < managers.length; i++) {
        if (managers[i] instanceof X509KeyManager) {
          X509KeyManager manager=(X509KeyManager)managers[i];
          managers[i]=new WrappedX509KeyManager(manager,keys);
        }
      }
      TrustManager[] trusts=new TrustManager[]{new AlwaysTrustManager(this.getTrustStore())};
      context.init(managers,trusts,this.rand);
      HttpsURLConnection.setDefaultSSLSocketFactory(context.getSocketFactory());
      HttpsURLConnection.setDefaultHostnameVerifier(new HostnameVerifier(){
        public boolean verify(        String urlHostname,        String certHostname){
          return true;
        }
      }
);
      log.debug("SSL stuff all set");
    }
 catch (    Exception e) {
      log.error("Exception occurred",e);
    }
    String[] dCiphers=this.context.getSocketFactory().getDefaultCipherSuites();
    String[] sCiphers=this.context.getSocketFactory().getSupportedCipherSuites();
    int len=(dCiphers.length > sCiphers.length) ? dCiphers.length : sCiphers.length;
    for (int i=0; i < len; i++) {
      if (i < dCiphers.length) {
        log.info("Default Cipher: " + dCiphers[i]);
      }
      if (i < sCiphers.length) {
        log.info("Supported Cipher: " + sCiphers[i]);
      }
    }
  }
  return this.context;
}
