{
  if (null == this.trustStore) {
    String fileName=JMeterUtils.getPropDefault(SSL_TRUST_STORE,"");
    System.setProperty(SSL_TRUST_STORE,fileName);
    try {
      if (fileName.endsWith(".iaik")) {
        this.trustStore=KeyStore.getInstance("IAIKKeyStore","IAIK");
      }
 else {
        this.trustStore=KeyStore.getInstance("JKS");
        log.info("KeyStore Type: JKS");
      }
    }
 catch (    Exception e) {
      JOptionPane.showMessageDialog(GuiPackage.getInstance().getMainFrame(),e,JMeterUtils.getResString("ssl_error_title"),JOptionPane.ERROR_MESSAGE);
      this.trustStore=null;
      throw new RuntimeException("TrustStore Problem");
    }
    try {
      File initStore=new File(fileName);
      if (initStore.exists()) {
        this.trustStore.load(new FileInputStream(initStore),null);
      }
 else {
        this.trustStore.load(null,null);
      }
    }
 catch (    Exception e) {
      throw new RuntimeException("Can't load TrustStore: " + e.toString());
    }
    log.info("TrustStore Location: " + fileName);
    log.info("TrustStore type: " + this.keyStore.getClass().toString());
  }
  return this.trustStore;
}
