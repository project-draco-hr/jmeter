{
  store.load(is,pword.toCharArray());
  ArrayList<String> v_names=new ArrayList<String>();
  ArrayList<PrivateKey> v_keys=new ArrayList<PrivateKey>();
  ArrayList<X509Certificate[]> v_certChains=new ArrayList<X509Certificate[]>();
  if (null != is) {
    PrivateKey _key=null;
    int index=0;
    Enumeration<String> aliases=store.aliases();
    while (aliases.hasMoreElements()) {
      String alias=aliases.nextElement();
      if (store.isKeyEntry(alias)) {
        if ((index >= startIndex && index <= endIndex)) {
          _key=(PrivateKey)store.getKey(alias,pword.toCharArray());
          if (null == _key) {
            throw new Exception("No key found for alias: " + alias);
          }
          Certificate[] chain=store.getCertificateChain(alias);
          if (null == chain) {
            throw new Exception("No certificate chain found for alias: " + alias);
          }
          v_names.add(alias);
          v_keys.add(_key);
          X509Certificate[] x509certs=new X509Certificate[chain.length];
          for (int i=0; i < x509certs.length; i++) {
            x509certs[i]=(X509Certificate)chain[i];
          }
          v_certChains.add(x509certs);
        }
      }
      index++;
    }
    if (null == _key) {
      throw new Exception("No key(s) found");
    }
    if (index <= endIndex - startIndex) {
      LOG.warn("Did not find all requested aliases. Start=" + startIndex + ", end="+ endIndex+ ", found="+ index);
    }
  }
  int v_size=v_names.size();
  this.names=new String[v_size];
  this.names=v_names.toArray(names);
  this.keys=new PrivateKey[v_size];
  this.keys=v_keys.toArray(keys);
  this.certChains=new X509Certificate[v_size][];
  this.certChains=v_certChains.toArray(certChains);
}
