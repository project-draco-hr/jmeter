{
  counter[0]++;
  JMeterVariables vars=getVariables();
  boolean perThread=Boolean.valueOf(((CompoundVariable)variables[0]).execute()).booleanValue();
  String varName=((CompoundVariable)variables[variables.length - 1]).execute();
  String counterString="";
  if (perThread) {
    int counterInt;
    try {
      counterInt=((Integer)vars.getObject(perThreadCounter)).intValue() + 1;
    }
 catch (    NullPointerException e) {
      counterInt=1;
    }
    vars.putObject(perThreadCounter,new Integer(counterInt));
    counterString=Integer.toString(counterInt);
  }
 else {
    counterString=String.valueOf(counter[0]);
  }
  if (varName.length() > 0)   vars.put(varName,counterString);
  return counterString;
}
