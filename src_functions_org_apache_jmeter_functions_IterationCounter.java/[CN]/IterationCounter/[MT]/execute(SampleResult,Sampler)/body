{
  counter++;
  JMeterVariables vars=getVariables();
  boolean perThread=new Boolean(((CompoundFunction)variables[0]).execute()).booleanValue();
  String varName=((CompoundFunction)variables[variables.length - 1]).execute();
  String counterString="";
  if (perThread) {
    counterString=Integer.toString(vars.getIteration());
  }
 else {
    counterString=Integer.toString(counter);
  }
  vars.put(varName,counterString);
  return counterString;
}
