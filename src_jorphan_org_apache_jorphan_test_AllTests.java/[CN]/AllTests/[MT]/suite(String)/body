{
  TestSuite suite=new TestSuite();
  try {
    Iterator classes=ClassFinder.findClassesThatExtend(JOrphanUtils.split(searchPaths,","),new Class[]{TestCase.class},true).iterator();
    while (classes.hasNext()) {
      String name=(String)classes.next();
      try {
        Class clazz=Class.forName(name);
        TestSuite ts=new TestSuite(clazz);
        if ((ts.testCount() == 1) && (ts.testAt(0).toString().startsWith("warning"))) {
          Method m;
          try {
            m=clazz.getMethod("makeSuite",new Class[0]);
            TestSuite t=(TestSuite)m.invoke(clazz,null);
            suite.addTest(t);
          }
 catch (          Exception e) {
            suite.addTest(ts);
          }
        }
 else {
          suite.addTest(ts);
        }
      }
 catch (      Exception ex) {
        System.out.println("Error adding test for class " + name + " "+ ex.toString());
        log.error("error adding test :" + ex);
      }
    }
  }
 catch (  IOException e) {
    log.error("",e);
  }
catch (  ClassNotFoundException e) {
    log.error("",e);
  }
  return suite;
}
