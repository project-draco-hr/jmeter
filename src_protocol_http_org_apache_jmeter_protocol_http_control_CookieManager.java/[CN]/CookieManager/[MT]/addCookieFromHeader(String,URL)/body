{
  StringTokenizer st=new StringTokenizer(cookieHeader,";");
  String nvp;
  nvp=st.nextToken();
  int index=nvp.indexOf("=");
  String name=nvp.substring(0,index);
  String value=nvp.substring(index + 1);
  String domain=url.getHost();
  String path="/";
  Cookie newCookie=new Cookie(name,value,domain,path,false,System.currentTimeMillis() + 1000 * 60 * 60* 24);
  while (st.hasMoreTokens()) {
    nvp=st.nextToken();
    nvp=nvp.trim();
    index=nvp.indexOf("=");
    if (index == -1) {
      index=nvp.length();
    }
    String key=nvp.substring(0,index);
    if (key.equalsIgnoreCase("expires")) {
      try {
        String expires=nvp.substring(index + 1);
        Date date=dateFormat.parse(expires);
        newCookie.setExpires(date.getTime());
      }
 catch (      ParseException pe) {
      }
    }
 else     if (key.equalsIgnoreCase("domain")) {
      newCookie.setDomain(nvp.substring(index + 1));
    }
 else     if (key.equalsIgnoreCase("path")) {
      newCookie.setPath(nvp.substring(index + 1));
    }
 else     if (key.equalsIgnoreCase("secure")) {
      newCookie.setSecure(true);
    }
  }
  Vector removeIndices=new Vector();
  for (int i=getCookies().size() - 1; i >= 0; i--) {
    Cookie cookie=(Cookie)getCookies().get(i).getObjectValue();
    if (cookie == null)     continue;
    if (cookie.getPath().equals(newCookie.getPath()) && cookie.getDomain().equals(newCookie.getDomain()) && cookie.getName().equals(newCookie.getName())) {
      removeIndices.addElement(new Integer(i));
    }
  }
  for (Enumeration e=removeIndices.elements(); e.hasMoreElements(); ) {
    index=((Integer)e.nextElement()).intValue();
    remove(index);
  }
  if (newCookie.getExpires() >= System.currentTimeMillis()) {
    add(newCookie);
  }
}
