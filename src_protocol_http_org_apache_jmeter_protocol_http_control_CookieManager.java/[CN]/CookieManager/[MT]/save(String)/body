{
  File file=new File(authFile);
  if (!file.isAbsolute()) {
    file=new File(System.getProperty("user.dir") + File.separator + authFile);
  }
  PrintWriter writer=new PrintWriter(new FileWriter(file));
  writer.println("# JMeter generated Cookie file");
  PropertyIterator cookies=getCookies().iterator();
  long now=System.currentTimeMillis();
  while (cookies.hasNext()) {
    Cookie cook=(Cookie)cookies.next().getObjectValue();
    final long expiresMillis=cook.getExpiresMillis();
    if (expiresMillis == 0 || expiresMillis > now) {
      writer.println(cookieToString(cook));
    }
  }
  writer.flush();
  writer.close();
}
