{
synchronized (hashHost) {
    if (hashHost.containsKey(host)) {
      log.debug(port + "Good, already in map, host=" + host);
      return hashHost.get(host);
    }
    try {
      SSLContext sslcontext=SSLContext.getInstance(SSLCONTEXT_PROTOCOL);
      sslcontext.init(getKeyManagers(CERT_ALIAS),null,null);
      SSLSocketFactory sslFactory=sslcontext.getSocketFactory();
      hashHost.put(host,sslFactory);
      log.info(port + "KeyStore for SSL loaded OK and put host in map (" + host+ ")");
      return sslFactory;
    }
 catch (    GeneralSecurityException e) {
      log.error(port + "Problem with SSL certificate",e);
    }
catch (    IOException e) {
      log.error(port + "Problem with keystore",e);
    }
    return null;
  }
}
