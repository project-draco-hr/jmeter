{
  try {
    String responseHeaders=massageResponseHeaders(res,forcedHTTPS);
    out.write(responseHeaders.getBytes());
    out.write(CRLF_BYTES);
    out.write(res.getResponseData());
    out.flush();
    log.debug("Done writing to client");
  }
 catch (  IOException e) {
    log.error("",e);
    throw e;
  }
 finally {
    try {
      out.close();
    }
 catch (    Exception ex) {
      log.warn("Error while closing socket",ex);
    }
  }
}
