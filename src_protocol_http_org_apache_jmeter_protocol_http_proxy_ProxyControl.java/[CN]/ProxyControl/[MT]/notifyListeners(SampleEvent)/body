{
  JMeterTreeModel treeModel=GuiPackage.getInstance().getTreeModel();
  List nodes=treeModel.getNodesOfType(RecordingController.class);
  if (nodes.size() == 0) {
    nodes=treeModel.getNodesOfType(ThreadGroup.class);
  }
  Iterator iter=nodes.iterator();
  while (iter.hasNext()) {
    JMeterTreeNode node=(JMeterTreeNode)iter.next();
    if (!node.isEnabled()) {
      continue;
    }
 else {
      Enumeration enum=node.children();
      while (enum.hasMoreElements()) {
        JMeterTreeNode subNode=(JMeterTreeNode)enum.nextElement();
        TestElement testElement=(TestElement)subNode.createTestElement();
        if (testElement instanceof SampleListener) {
          ((SampleListener)testElement).sampleOccurred(event);
        }
      }
    }
  }
}
