{
  String pathAndQuery=null;
  log.debug("#4, encoded path = " + getEncodedPath());
  if (this.getMethod().equals(HTTPSampler.GET) && getQueryString().length() > 0) {
    log.debug("Path = " + getPath() + "Encoded path = "+ getEncodedPath());
    if (this.getEncodedPath().indexOf("?") > -1) {
      pathAndQuery=this.getEncodedPath() + "&" + getQueryString();
    }
 else {
      pathAndQuery=this.getEncodedPath() + "?" + getQueryString();
    }
  }
 else {
    log.debug("Path = " + getPath() + "Encoded path = "+ getEncodedPath());
    pathAndQuery=this.getEncodedPath();
  }
  if (!pathAndQuery.startsWith("/")) {
    pathAndQuery="/" + pathAndQuery;
  }
  if (getPort() == UNSPECIFIED_PORT) {
    return new URL(getProtocol(),getDomain(),pathAndQuery);
  }
 else {
    return new URL(getProtocol(),getPropertyAsString(HTTPSampler.DOMAIN),getPort(),pathAndQuery);
  }
}
