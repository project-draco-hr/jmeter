{
  if (url == null || url.toLowerCase().startsWith("file:")) {
    return url;
  }
  try {
    String escapedUrl=ConversionUtils.escapeIllegalURLCharacters(url);
    if (!escapedUrl.equals(url) && log.isDebugEnabled()) {
      log.debug("Url '" + url + "' has been escaped to '"+ escapedUrl+ "'. Please correct your webpage.");
    }
    return escapedUrl;
  }
 catch (  Exception e1) {
    log.error("Error escaping URL:'" + url + "', message:"+ e1.getMessage());
    return url;
  }
}
