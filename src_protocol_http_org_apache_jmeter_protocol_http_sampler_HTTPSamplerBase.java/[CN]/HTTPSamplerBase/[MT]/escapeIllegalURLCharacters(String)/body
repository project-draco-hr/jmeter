{
  if (url == null || StringUtils.startsWithIgnoreCase(url,"file:")) {
    return url;
  }
  try {
    String escapedUrl=ConversionUtils.escapeIllegalURLCharacters(url);
    if (log.isDebugEnabled() && !escapedUrl.equals(url)) {
      log.debug("Url '" + url + "' has been escaped to '"+ escapedUrl+ "'. Please correct your webpage.");
    }
    return escapedUrl;
  }
 catch (  Exception e1) {
    log.error("Error escaping URL:'" + url + "', message:"+ e1.getMessage());
    return url;
  }
}
