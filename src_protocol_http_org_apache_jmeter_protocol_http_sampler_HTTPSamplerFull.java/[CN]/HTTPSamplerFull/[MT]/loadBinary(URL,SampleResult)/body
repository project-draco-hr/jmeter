{
  log.debug("Start : loadBinary");
  byte[] ret=new byte[0];
  res.setSamplerData(new HTTPSampler(url));
  try {
    conn=setupConnection(url,GET);
    connect();
  }
 catch (  IOException ioe) {
    if (log.isDebugEnabled()) {
      log.debug("loadBinary : error in setupConnection " + ioe);
    }
    throw ioe;
  }
  try {
    long time=System.currentTimeMillis();
    if (log.isDebugEnabled()) {
      log.debug("loadBinary : start time - " + time);
    }
    int errorLevel=getErrorLevel(conn,res);
    if (errorLevel == 2) {
      ret=readResponse(conn);
      res.setSuccessful(true);
      long endTime=System.currentTimeMillis();
      if (log.isDebugEnabled()) {
        log.debug("loadBinary : end   time - " + endTime);
      }
      res.setTime(endTime - time);
    }
 else {
      res.setSuccessful(false);
      int responseCode=((HttpURLConnection)conn).getResponseCode();
      String responseMsg=((HttpURLConnection)conn).getResponseMessage();
      log.error("loadBinary : failed code - " + responseCode);
      log.error("loadBinary : failed message - " + responseMsg);
    }
    if (log.isDebugEnabled()) {
      log.debug("loadBinary : binary - " + ret[0] + ret[1]);
      log.debug("loadBinary : loadTime - " + res.getTime());
    }
    log.debug("End   : loadBinary");
    res.setResponseData(ret);
    res.setDataType(SampleResult.BINARY);
    return ret;
  }
  finally {
    try {
      String connection=conn.getHeaderField("Connection");
      if (connection == null || connection.equalsIgnoreCase("close")) {
        conn.disconnect();
      }
    }
 catch (    Exception e) {
    }
  }
}
