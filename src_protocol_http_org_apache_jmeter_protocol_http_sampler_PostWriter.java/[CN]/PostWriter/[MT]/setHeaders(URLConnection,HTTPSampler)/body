{
  ((HttpURLConnection)connection).setRequestMethod(HTTPSamplerBase.POST);
  String filename=sampler.getFilename();
  if ((filename != null) && (filename.trim().length() > 0)) {
    connection.setRequestProperty(HTTPSamplerBase.HEADER_CONTENT_TYPE,"multipart/form-data; boundary=" + BOUNDARY);
    connection.setDoOutput(true);
    connection.setDoInput(true);
  }
 else {
    String postData=sampler.getQueryString();
    connection.setRequestProperty(HTTPSamplerBase.HEADER_CONTENT_LENGTH,Integer.toString(postData.length()));
    connection.setRequestProperty(HTTPSamplerBase.HEADER_CONTENT_TYPE,"application/x-www-form-urlencoded");
    connection.setDoOutput(true);
  }
}
