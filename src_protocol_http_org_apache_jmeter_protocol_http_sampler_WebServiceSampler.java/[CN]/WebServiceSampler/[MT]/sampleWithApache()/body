{
  try {
    Envelope msgEnv=Envelope.unmarshall(createDocument());
    Message msg=new Message();
    RESULT.sampleStart();
    if (this.getUseProxy()) {
      String phost="";
      int pport=0;
      if (this.getProxyHost().length() > 0 && this.getProxyPort() > 0) {
        phost=this.getProxyHost();
        pport=this.getProxyPort();
      }
 else {
        if (System.getProperty("http.proxyHost") != null || System.getProperty("http.proxyPort") != null) {
          phost=System.getProperty("http.proxyHost");
          pport=Integer.parseInt(System.getProperty("http.proxyPort"));
        }
      }
      SOAPHTTPConnection spconn=new SOAPHTTPConnection();
      spconn.setProxyHost(phost);
      spconn.setProxyPort(pport);
      msg.setSOAPTransport(spconn);
    }
    msg.send(this.getUrl(),this.getSoapAction(),msgEnv);
    SOAPTransport st=msg.getSOAPTransport();
    BufferedReader br=st.receive();
    RESULT.setDataType(SampleResult.TEXT);
    if (this.getPropertyAsBoolean(READ_RESPONSE)) {
      StringBuffer buf=new StringBuffer();
      String line;
      while ((line=br.readLine()) != null) {
        buf.append(line);
      }
      RESULT.sampleEnd();
      RESULT.setResponseData(buf.toString().getBytes());
    }
 else {
      br.read();
      RESULT.sampleEnd();
      RESULT.setResponseData(JMeterUtils.getResString("read_response_message").getBytes());
    }
    RESULT.setSuccessful(true);
    RESULT.setSamplerData(getUrl().getProtocol() + "://" + getUrl().getHost()+ "/"+ getUrl().getFile());
    RESULT.setDataEncoding(st.getResponseSOAPContext().getContentType());
    RESULT.setResponseCode("200");
    br.close();
    msg=null;
    st=null;
  }
 catch (  Exception exception) {
    RESULT.setSuccessful(false);
  }
}
