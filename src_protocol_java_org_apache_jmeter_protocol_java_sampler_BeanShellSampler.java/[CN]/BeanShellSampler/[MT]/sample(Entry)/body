{
  SampleResult res=new SampleResult();
  boolean isSuccessful=false;
  res.setSampleLabel(getLabel());
  res.sampleStart();
  try {
    String request=getScript();
    String fileName=getFilename();
    if (fileName.length() == 0) {
      res.setSamplerData(request);
    }
 else {
      res.setSamplerData(fileName);
    }
    bshInterpreter.set("Label",getLabel());
    bshInterpreter.set("FileName",getFilename());
    bshInterpreter.set("SampleResult",res);
    bshInterpreter.set("Parameters",getParameters());
    bshInterpreter.set("bsh.args",JOrphanUtils.split(getParameters()," "));
    bshInterpreter.set("ResponseCode","200");
    bshInterpreter.set("ResponseMessage","OK");
    bshInterpreter.set("IsSuccess",true);
    Object bshOut;
    if (fileName.length() == 0) {
      bshOut=bshInterpreter.eval(request);
    }
 else {
      bshOut=bshInterpreter.source(fileName);
    }
    String out;
    if (bshOut == null) {
      out="";
    }
 else {
      out=bshOut.toString();
    }
    res.setResponseData(out.getBytes());
    res.setDataType(SampleResult.TEXT);
    res.setResponseCode(bshInterpreter.get("ResponseCode").toString());
    res.setResponseMessage(bshInterpreter.get("ResponseMessage").toString());
    isSuccessful=Boolean.valueOf(bshInterpreter.get("IsSuccess").toString()).booleanValue();
  }
 catch (  NoClassDefFoundError ex) {
    log.error("BeanShell Jar missing? " + ex.toString());
    res.setResponseCode("501");
    res.setResponseMessage(ex.toString());
    res.setStopThread(true);
  }
catch (  IOException ex) {
    log.warn(ex.toString());
    res.setResponseCode("500");
    res.setResponseMessage(ex.toString());
  }
catch (  Exception ex) {
    log.warn(ex.toString());
    res.setResponseCode("500");
    res.setResponseMessage(ex.toString());
  }
  res.sampleEnd();
  res.setSuccessful(isSuccessful);
  return res;
}
