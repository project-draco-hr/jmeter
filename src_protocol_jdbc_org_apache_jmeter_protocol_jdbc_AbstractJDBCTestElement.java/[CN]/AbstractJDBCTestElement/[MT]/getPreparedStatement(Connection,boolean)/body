{
  Map<String,PreparedStatement> preparedStatementMap=perConnCache.get(conn);
  if (null == preparedStatementMap) {
    preparedStatementMap=new ConcurrentHashMap<String,PreparedStatement>();
    perConnCache.put(conn,preparedStatementMap);
  }
  PreparedStatement pstmt=preparedStatementMap.get(getQuery());
  if (null == pstmt) {
    if (callable) {
      pstmt=conn.prepareCall(getQuery());
    }
 else {
      pstmt=conn.prepareStatement(getQuery());
    }
    preparedStatementMap.put(getQuery(),pstmt);
  }
  pstmt.clearParameters();
  return pstmt;
}
