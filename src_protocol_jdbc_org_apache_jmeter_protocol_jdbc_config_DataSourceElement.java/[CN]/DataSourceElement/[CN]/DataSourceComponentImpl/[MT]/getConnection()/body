{
  Connection conn=null;
  ResourceLimitingJdbcDataSource dsc=null;
  if (sharedDSC != null) {
    dsc=sharedDSC;
  }
 else {
    Map<String,ResourceLimitingJdbcDataSource> poolMap=(Map)perThreadPoolMap.get();
    dsc=poolMap.get(getDataSource());
    if (dsc == null) {
      dsc=initPool("1");
      poolMap.put(getDataSource(),dsc);
      log.debug("Storing pool: " + dsc.getInstrumentableName() + " @"+ System.identityHashCode(dsc));
      perThreadPoolSet.add(dsc);
    }
  }
  if (dsc != null) {
    conn=dsc.getConnection();
  }
  return conn;
}
