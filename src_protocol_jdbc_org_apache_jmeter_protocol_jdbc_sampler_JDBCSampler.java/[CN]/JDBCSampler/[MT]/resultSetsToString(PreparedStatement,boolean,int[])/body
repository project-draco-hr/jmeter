{
  StringBuffer sb=new StringBuffer();
  sb.append("\n");
  int updateCount=0;
  if (!result) {
    updateCount=pstmt.getUpdateCount();
  }
  do {
    if (result) {
      ResultSet rs=null;
      try {
        rs=pstmt.getResultSet();
        Data data=getDataFromResultSet(rs);
        sb.append(data.toString()).append("\n");
      }
  finally {
        close(rs);
      }
    }
 else {
      sb.append(updateCount).append(" updates.\n");
    }
    result=pstmt.getMoreResults();
    if (!result) {
      updateCount=pstmt.getUpdateCount();
    }
  }
 while (result || (updateCount != -1));
  if (out != null && pstmt instanceof CallableStatement) {
    CallableStatement cs=(CallableStatement)pstmt;
    sb.append("Output variables by position:\n");
    for (int i=0; i < out.length; i++) {
      if (out[i] != java.sql.Types.NULL) {
        sb.append("[");
        sb.append(i + 1);
        sb.append("] ");
        sb.append(cs.getObject(i + 1));
        sb.append("\n");
      }
    }
  }
  return sb.toString();
}
