{
  ConnectionObject[] connectionArray=(ConnectionObject[])connections.get(key);
  if (connectionArray == null || connectionArray.length == 0) {
    throw new NoConnectionsAvailableException();
  }
  int maxConnections=key.getMaxConnections();
  Connection c=null;
  int index=(int)(100 * Math.random());
  int count=-1;
  while (++count < maxConnections && c == null) {
    index++;
    c=connectionArray[index % maxConnections].grab();
  }
  if (c != null)   rentedConnections.put(c,connectionArray[index % maxConnections]);
  return c;
}
