{
  Context ctx=MAP.get(initialContextFactory + providerUrl);
  if (ctx == null) {
    Properties props=new Properties();
    props.setProperty(Context.INITIAL_CONTEXT_FACTORY,initialContextFactory);
    props.setProperty(Context.PROVIDER_URL,providerUrl);
    if (useAuth && securityPrincipal != null && securityCredentials != null && securityPrincipal.length() > 0 && securityCredentials.length() > 0) {
      props.setProperty(Context.SECURITY_PRINCIPAL,securityPrincipal);
      props.setProperty(Context.SECURITY_CREDENTIALS,securityCredentials);
      log.info("authentication properties set");
    }
    try {
      ctx=new InitialContext(props);
      log.info("created the JNDI initial context factory");
    }
 catch (    NamingException e) {
      log.error("lookupContext:: " + e.getMessage());
    }
    if (ctx != null) {
      MAP.put(initialContextFactory + providerUrl,ctx);
    }
  }
  return ctx;
}
