{
  try {
    ConnectionFactory.getTopicConnectionFactory(ctx,connfactory);
    connection=ConnectionFactory.getTopicConnection();
    topic=InitialContextFactory.lookupTopic(ctx,topicName);
    session=connection.createTopicSession(false,TopicSession.AUTO_ACKNOWLEDGE);
    publisher=session.createPublisher(topic);
    log.info("created the topic connection successfully");
  }
 catch (  JMSException e) {
    log.error("Connection error: " + e.getMessage());
  }
}
