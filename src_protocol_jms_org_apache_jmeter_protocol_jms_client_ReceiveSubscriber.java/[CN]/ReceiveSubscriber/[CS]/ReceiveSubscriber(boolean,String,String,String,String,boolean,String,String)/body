{
  Context ctx=initJNDI(useProps,jndi,url,useAuth,user,pwd);
  TopicConnection _conn=null;
  Topic _topic=null;
  TopicSession _session=null;
  TopicSubscriber _subscriber=null;
  if (ctx != null) {
    try {
      ConnectionFactory.getTopicConnectionFactory(ctx,connfactory);
      _conn=ConnectionFactory.getTopicConnection();
      _topic=Utils.lookupTopic(ctx,topic);
      if (_topic == null) {
        log.warn("topic <" + topic + "> could not be found.");
      }
      _session=_conn.createTopicSession(false,TopicSession.AUTO_ACKNOWLEDGE);
      _subscriber=_session.createSubscriber(_topic);
      log.info("created the topic connection successfully");
    }
 catch (    JMSException e) {
      log.error("Connection error: " + e.getMessage());
    }
  }
 else {
    log.error("Could not initialize JNDI Initial Context Factory");
  }
  this.CONN=_conn;
  this.SESSION=_session;
  this.SUBSCRIBER=_subscriber;
}
