{
  while (RUN) {
    try {
      Message message=this.SUBSCRIBER.receive();
      if (message instanceof TextMessage || message instanceof MapMessage) {
        queue.add(message);
        count(1);
      }
 else       if (message != null) {
        log.warn("Discarded non Map|TextMessage " + message);
      }
    }
 catch (    JMSException e) {
      log.error("Communication error: " + e.getMessage());
    }
  }
}
