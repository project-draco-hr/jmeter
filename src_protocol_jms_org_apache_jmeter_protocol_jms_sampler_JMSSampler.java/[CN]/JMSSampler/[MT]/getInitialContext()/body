{
  Hashtable table=new Hashtable();
  if (getInitialContextFactory() != null && getInitialContextFactory().trim().length() > 0) {
    if (LOGGER.isDebugEnabled()) {
      LOGGER.debug("Using InitialContext [" + getInitialContextFactory() + "]");
    }
    table.put(Context.INITIAL_CONTEXT_FACTORY,getInitialContextFactory());
  }
  if (getContextProvider() != null && getContextProvider().trim().length() > 0) {
    if (LOGGER.isDebugEnabled()) {
      LOGGER.debug("Using Provider [" + getContextProvider() + "]");
    }
    table.put(Context.PROVIDER_URL,getContextProvider());
  }
  Map map=getArguments(JMSSampler.JNDI_PROPERTIES).getArgumentsAsMap();
  if (LOGGER.isDebugEnabled()) {
    if (map.isEmpty()) {
      LOGGER.debug("Empty JNDI properties");
    }
 else {
      LOGGER.debug("Number of JNDI properties: " + map.size());
    }
  }
  Iterator it=map.keySet().iterator();
  while (it.hasNext()) {
    String key=(String)it.next();
    table.put(key,map.get(key));
  }
  Context context=new InitialContext(table);
  if (LOGGER.isDebugEnabled()) {
    printEnvironment(context);
  }
  return context;
}
