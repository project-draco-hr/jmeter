{
  SampleResult res=new SampleResult();
  boolean isSuccessful=false;
  res.setSampleLabel(getLabel());
  res.setSamplerData(getPropertyAsString(TEST));
  long time=0L;
  LdapClient ldap=new LdapClient();
  try {
    ldap.connect(getServername(),getPort(),getRootdn(),getUsername(),getPassword());
    if (getPropertyAsString(TEST).equals("add")) {
      time=addTest(ldap);
    }
 else     if (getPropertyAsString(TEST).equals("delete")) {
      time=deleteTest(ldap);
    }
 else     if (getPropertyAsString(TEST).equals("modify")) {
      time=modifyTest(ldap);
    }
 else     if (getPropertyAsString(TEST).equals("search")) {
      time=searchTest(ldap);
    }
    if (getPropertyAsString(TEST).equals("search") && !searchFoundEntries) {
      res.setResponseCode("201");
      res.setResponseMessage("OK - no results");
      res.setResponseData("successful - no results".getBytes());
    }
 else {
      res.setResponseCode("200");
      res.setResponseMessage("OK");
      res.setResponseData("successful".getBytes());
    }
    res.setDataType(SampleResult.TEXT);
    isSuccessful=true;
    ldap.disconnect();
  }
 catch (  Exception ex) {
    log.error("Ldap client - ",ex);
    res.setResponseCode("500");
    res.setResponseMessage(ex.toString());
    ldap.disconnect();
    isSuccessful=false;
    time=0L;
  }
  res.setTime(time);
  res.setSuccessful(isSuccessful);
  return res;
}
