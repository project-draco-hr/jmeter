{
  Iterator iter=new LinkedList(tree.list()).iterator();
  while (iter.hasNext()) {
    Object o=iter.next();
    if (o instanceof TestElement) {
      continue;
    }
    ReportTreeNode item=(ReportTreeNode)o;
    if (item.isEnabled()) {
      if (item.getUserObject() instanceof ReplaceableController) {
        ReplaceableController rc=(ReplaceableController)item.getTestElement();
        HashTree subTree=tree.getTree(item);
        if (subTree != null) {
          HashTree replacementTree=rc.getReplacementSubTree();
          convertSubTree(replacementTree);
          tree.replace(item,rc);
          tree.set(rc,replacementTree);
        }
      }
 else {
        convertSubTree(tree.getTree(item));
        TestElement testElement=item.getTestElement();
        tree.replace(item,testElement);
      }
    }
 else {
      tree.remove(item);
    }
  }
}
