{
  if (dragging && isValidDragAction(draggedNodes,getCurrentNode())) {
    dragging=false;
    JPopupMenu dragNdrop=new JPopupMenu();
    JMenuItem item=new JMenuItem(JMeterUtils.getResString("insert_before"));
    item.addActionListener(actionHandler);
    item.setActionCommand(ReportDragNDrop.INSERT_BEFORE);
    dragNdrop.add(item);
    item=new JMenuItem(JMeterUtils.getResString("insert_after"));
    item.addActionListener(actionHandler);
    item.setActionCommand(ReportDragNDrop.INSERT_AFTER);
    dragNdrop.add(item);
    item=new JMenuItem(JMeterUtils.getResString("add_as_child"));
    item.addActionListener(actionHandler);
    item.setActionCommand(ReportDragNDrop.ADD);
    dragNdrop.add(item);
    dragNdrop.addSeparator();
    item=new JMenuItem(JMeterUtils.getResString("cancel"));
    dragNdrop.add(item);
    displayPopUp(e,dragNdrop);
  }
 else {
    ReportGuiPackage.getInstance().getMainFrame().repaint();
  }
  dragging=false;
}
