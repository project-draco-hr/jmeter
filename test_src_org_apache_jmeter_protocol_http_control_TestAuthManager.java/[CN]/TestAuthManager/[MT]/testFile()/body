{
  AuthManager am=new AuthManager();
  CollectionProperty ao=am.getAuthObjects();
  assertEquals(0,ao.size());
  am.addFile(findTestPath("testfiles/TestAuth.txt"));
  assertEquals(9,ao.size());
  Authorization at;
  at=am.getAuthForURL(new URL("http://a.b.c/"));
  assertEquals("login",at.getUser());
  assertEquals("password",at.getPass());
  at=am.getAuthForURL(new URL("http://a.b.c:80/"));
  assertEquals("login",at.getUser());
  assertEquals("password",at.getPass());
  at=am.getAuthForURL(new URL("http://a.b.c:443/"));
  assertNull(at);
  at=am.getAuthForURL(new URL("http://a.b.c/1"));
  assertEquals("login1",at.getUser());
  assertEquals("password1",at.getPass());
  assertEquals("",at.getDomain());
  assertEquals("",at.getRealm());
  at=am.getAuthForURL(new URL("http://d.e.f/"));
  assertEquals("user",at.getUser());
  assertEquals("pass",at.getPass());
  assertEquals("domain",at.getDomain());
  assertEquals("realm",at.getRealm());
  at=am.getAuthForURL(new URL("https://j.k.l/"));
  assertEquals("jkl",at.getUser());
  assertEquals("pass",at.getPass());
  at=am.getAuthForURL(new URL("https://j.k.l:443/"));
  assertEquals("jkl",at.getUser());
  assertEquals("pass",at.getPass());
  at=am.getAuthForURL(new URL("https://l.m.n/"));
  assertEquals("lmn443",at.getUser());
  assertEquals("pass",at.getPass());
  at=am.getAuthForURL(new URL("https://l.m.n:443/"));
  assertEquals("lmn443",at.getUser());
  assertEquals("pass",at.getPass());
  at=am.getAuthForURL(new URL("https://l.m.n:8443/"));
  assertEquals("lmn8443",at.getUser());
  assertEquals("pass",at.getPass());
}
