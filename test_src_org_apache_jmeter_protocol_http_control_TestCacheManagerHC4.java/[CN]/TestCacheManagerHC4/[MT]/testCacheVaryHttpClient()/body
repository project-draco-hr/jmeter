{
  this.cacheManager.setUseExpires(true);
  this.cacheManager.testIterationStart(null);
  assertNull("Should not find entry",getThreadCacheEntry(LOCAL_HOST));
  assertFalse("Should not find valid entry",this.cacheManager.inCache(url));
  ((HttpResponseStub)httpResponse).expires=makeDate(new Date(System.currentTimeMillis()));
  ((HttpResponseStub)httpResponse).cacheControl="public, max-age=5";
  this.vary="Something";
  this.cacheManager.saveDetails(httpResponse,sampleResultOK);
  assertNull("Should not find entry",getThreadCacheEntry(LOCAL_HOST));
  assertFalse("Should not find valid entry",this.cacheManager.inCache(url));
  this.vary=null;
}
