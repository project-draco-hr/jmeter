{
  String titleField="title";
  String titleValue="mytitle";
  String descriptionField="description";
  String descriptionValue="mydescription";
  setupFormData(sampler,titleValue,descriptionValue);
  sampler.setDoMultipartPost(true);
  String contentEncoding="";
  sampler.setContentEncoding(contentEncoding);
  postWriter.setHeaders(connection,sampler);
  postWriter.sendPostData(connection,sampler);
  checkContentTypeMultipart(connection,PostWriter.BOUNDARY);
  byte[] expectedFormBody=createExpectedFormdataOutput(PostWriter.BOUNDARY,null,titleField,titleValue,descriptionField,descriptionValue,true,true);
  checkContentLength(connection,expectedFormBody.length);
  checkArraysHaveSameContent(expectedFormBody,connection.getOutputStreamContent());
  connection.disconnect();
  establishConnection();
  contentEncoding="ISO-8859-1";
  sampler.setContentEncoding(contentEncoding);
  postWriter.setHeaders(connection,sampler);
  postWriter.sendPostData(connection,sampler);
  checkContentTypeMultipart(connection,PostWriter.BOUNDARY);
  expectedFormBody=createExpectedFormdataOutput(PostWriter.BOUNDARY,contentEncoding,titleField,titleValue,descriptionField,descriptionValue,true,true);
  checkContentLength(connection,expectedFormBody.length);
  checkArraysHaveSameContent(expectedFormBody,connection.getOutputStreamContent());
  connection.disconnect();
  establishConnection();
  titleValue="mytitle+123 456&yes";
  descriptionValue="mydescription and some spaces";
  contentEncoding="ISO-8859-1";
  sampler.setContentEncoding(contentEncoding);
  setupFormData(sampler,titleValue,descriptionValue);
  postWriter.setHeaders(connection,sampler);
  postWriter.sendPostData(connection,sampler);
  checkContentTypeMultipart(connection,PostWriter.BOUNDARY);
  expectedFormBody=createExpectedFormdataOutput(PostWriter.BOUNDARY,contentEncoding,titleField,titleValue,descriptionField,descriptionValue,true,true);
  checkContentLength(connection,expectedFormBody.length);
  checkArraysHaveSameContent(expectedFormBody,connection.getOutputStreamContent());
  connection.disconnect();
  establishConnection();
  titleValue="mytitle\u0153\u20a1\u0115\u00c5";
  descriptionValue="mydescription\u0153\u20a1\u0115\u00c5";
  contentEncoding=UTF_8;
  sampler.setContentEncoding(contentEncoding);
  setupFormData(sampler,titleValue,descriptionValue);
  postWriter.setHeaders(connection,sampler);
  postWriter.sendPostData(connection,sampler);
  checkContentTypeMultipart(connection,PostWriter.BOUNDARY);
  expectedFormBody=createExpectedFormdataOutput(PostWriter.BOUNDARY,contentEncoding,titleField,titleValue,descriptionField,descriptionValue,true,true);
  checkContentLength(connection,expectedFormBody.length);
  checkArraysHaveSameContent(expectedFormBody,connection.getOutputStreamContent());
  connection.disconnect();
  establishConnection();
  titleValue="mytitle\u0153+\u20a1 \u0115&yes\u00c5";
  descriptionValue="mydescription \u0153 \u20a1 \u0115 \u00c5";
  contentEncoding=UTF_8;
  sampler.setContentEncoding(contentEncoding);
  setupFormData(sampler,titleValue,descriptionValue);
  postWriter.setHeaders(connection,sampler);
  postWriter.sendPostData(connection,sampler);
  checkContentTypeMultipart(connection,PostWriter.BOUNDARY);
  expectedFormBody=createExpectedFormdataOutput(PostWriter.BOUNDARY,contentEncoding,titleField,titleValue,descriptionField,descriptionValue,true,true);
  checkContentLength(connection,expectedFormBody.length);
  checkArraysHaveSameContent(expectedFormBody,connection.getOutputStreamContent());
  connection.disconnect();
}
