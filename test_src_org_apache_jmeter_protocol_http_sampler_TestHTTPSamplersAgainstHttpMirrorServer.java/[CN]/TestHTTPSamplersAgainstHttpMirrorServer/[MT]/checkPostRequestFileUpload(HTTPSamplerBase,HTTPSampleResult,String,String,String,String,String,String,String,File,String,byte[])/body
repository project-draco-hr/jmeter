{
  if (contentEncoding == null || contentEncoding.length() == 0) {
    contentEncoding=samplerDefaultEncoding;
  }
  assertEquals(sampler.getUrl(),res.getURL());
  String boundaryString=getBoundaryStringFromContentType(res.getRequestHeaders());
  assertNotNull(boundaryString);
  byte[] expectedPostBody=createExpectedFormAndUploadOutput(boundaryString,contentEncoding,titleField,titleValue,descriptionField,descriptionValue,fileField,fileValue,fileMimeType,fileContent);
  assertTrue(isInRequestHeaders(res.getRequestHeaders(),HTTPSamplerBase.HEADER_CONTENT_TYPE,"multipart/form-data" + "; boundary=" + boundaryString));
  assertTrue(isInRequestHeaders(res.getRequestHeaders(),HTTPSamplerBase.HEADER_CONTENT_LENGTH,Integer.toString(expectedPostBody.length)));
  String headersSent=getHeadersSent(res.getResponseData());
  if (headersSent == null) {
    fail("No header and body section found");
  }
  assertTrue(isInRequestHeaders(headersSent,HTTPSamplerBase.HEADER_CONTENT_TYPE,"multipart/form-data" + "; boundary=" + boundaryString));
  assertTrue(isInRequestHeaders(headersSent,HTTPSamplerBase.HEADER_CONTENT_LENGTH,Integer.toString(expectedPostBody.length)));
  byte[] bodySent=getBodySent(res.getResponseData());
  assertNotNull("Sent body should not be null",bodySent);
  checkArraysHaveSameContent(expectedPostBody,bodySent);
  checkMethodPathQuery(headersSent,sampler.getMethod(),sampler.getPath(),null);
}
