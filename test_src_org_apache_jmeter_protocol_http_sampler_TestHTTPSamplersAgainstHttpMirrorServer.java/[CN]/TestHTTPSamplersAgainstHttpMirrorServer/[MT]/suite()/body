{
  TestSetup setup=new TestSetup(new TestSuite(TestHTTPSamplersAgainstHttpMirrorServer.class)){
    private int webServerPort=8080;
    private HttpMirrorControl webServerControl;
    protected void setUp() throws Exception {
      webServerControl=new HttpMirrorControl();
      webServerControl.setPort(webServerPort);
      webServerControl.startHttpMirror();
      TEST_FILE_CONTENT=new String("some foo content &?=01234+56789-\u007c\u2aa1\u266a\u0153\u20a1\u0115\u0364\u00c5\u2052\uc385%C3%85").getBytes("UTF-8");
      temporaryFile=File.createTempFile("TestHTTPSamplersAgainstHttpMirrorServer","tmp");
      OutputStream output=new FileOutputStream(temporaryFile);
      output.write(TEST_FILE_CONTENT);
      output.flush();
      output.close();
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
      }
      if (!webServerControl.isServerAlive()) {
        throw new Exception("Could not start mirror server");
      }
    }
    protected void tearDown() throws Exception {
      webServerControl.stopHttpMirror();
      temporaryFile.delete();
    }
  }
;
  return setup;
}
