{
  TestSuite suite=new TestSuite("Bean Resource Test Suite");
  Iterator iter=ClassFinder.findClassesThatExtend(JMeterUtils.getSearchPaths(),new Class[]{TestBean.class}).iterator();
  boolean errorDetected=false;
  while (iter.hasNext()) {
    String className=(String)iter.next();
    Class testBeanClass=Class.forName(className);
    JMeterUtils.setLocale(defaultLocale);
    ResourceBundle defaultBundle=null;
    try {
      defaultBundle=(ResourceBundle)Introspector.getBeanInfo(testBeanClass).getBeanDescriptor().getValue(GenericTestBeanCustomizer.RESOURCE_BUNDLE);
    }
 catch (    IntrospectionException e) {
      log.error("Can't get beanInfo for " + testBeanClass.getName(),e);
      throw new Error(e.toString());
    }
    if (defaultBundle == null) {
      if (className.startsWith("org.apache.jmeter.examples.")) {
        log.info("No default bundle found for " + className);
        continue;
      }
      errorDetected=true;
      log.error("No default bundle found for " + className);
      continue;
    }
    suite.addTest(new PackageTest(testBeanClass,defaultLocale,defaultBundle));
    for (int i=0; i < locales.length; i++) {
      suite.addTest(new PackageTest(testBeanClass,locales[i],defaultBundle));
    }
  }
  if (errorDetected) {
    suite.addTest(new PackageTest("errorDetected"));
  }
  return suite;
}
