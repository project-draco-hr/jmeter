{
  TestSuite suite=new TestSuite("All Tests");
  System.out.println("Scanning " + searchPaths + " for test cases");
  int tests=0;
  int suites=0;
  try {
    log.info("ClassFinder(TestCase)");
    List classList=ClassFinder.findClassesThatExtend(JOrphanUtils.split(searchPaths,","),new Class[]{TestCase.class},true);
    int sz=classList.size();
    log.info("ClassFinder(TestCase) found: " + sz + " TestCase classes");
    System.out.println("ClassFinder found: " + sz + " TestCase classes");
    Iterator classes=classList.iterator();
    while (classes.hasNext()) {
      String name=(String)classes.next();
      try {
        Class clazz=Class.forName(name);
        Test t=null;
        try {
          Method m=clazz.getMethod("suite",new Class[0]);
          t=(Test)m.invoke(clazz,null);
          suites++;
        }
 catch (        NoSuchMethodException e) {
        }
        if (t == null) {
          t=new TestSuite(clazz);
        }
        tests++;
        suite.addTest(t);
      }
 catch (      Exception ex) {
        System.out.println("Error adding test for class " + name + " "+ ex.toString());
        log.error("error adding test :",ex);
      }
    }
  }
 catch (  IOException e) {
    log.error("",e);
  }
  System.out.println("Created: " + tests + " tests including "+ suites+ " suites");
  return suite;
}
